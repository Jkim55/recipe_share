#recipe_show.row
  .col-md-12
    .panel.panel-default
      .panel-heading.pin-image
        .row
          .col-md-4
            = image_tag @recipe.image.url(:large)
          .col-md-4.col-md-offset-4
            .row
              .col-md-12
                %h1= @recipe.title
              .col-md-12
                Shared by
                = @recipe.user.username
                -# on
                -# = @recipe.updated_at

              .col-md-12
                %p
                = link_to like_recipe_path(@recipe), method: :put, class: "btn btn-default btn-xs" do
                  %span.glyphicon.glyphicon-heart
                  = @recipe.get_upvotes.size
                - if user_signed_in? && (@recipe.user.id  == current_user.id)
                  = link_to "Edit", edit_recipe_path, class: "btn btn-default btn-xs"
                  = link_to "Delete", recipe_path, method: :delete, data: {confirm: "Are you sure?" }, class: "btn btn-default btn-xs"

              .col-md-12
                %br/
                %p= @recipe.description
                %p #{@recipe.serving} servings

                %h4 Dietary Restrictions
                %ul
                - if @recipe.categories.length == 0
                  %li No Dietary Accommodations Listed
                - else
                  - @recipe.categories.each do |c|
                    %li= c.name

                %h4 Meal/Course
                %ul
                - if @recipe.courses.length == 0
                  %li No Courses Indicated
                - else
                  - @recipe.courses.each do |c|
                    %li= c.name

      .panel-body
        .row
          .col-md-4
            %h2 Ingredients
            - @recipe.ingredients.each do |ingredient|
              %p
              %span= ingredient.name
              - if ingredient.image?
                %span= link_to glyph(:camera), ingredient.image.url(:med), data: {toggle: "modal", target: "#modal"}

          .col-md-8
            %h2 Directions
            - @recipe.directions.each do |direction|
              %p
              %span= direction.step
              - if direction.attachment?
                %span= link_to glyph(:facetime_video), direction.attachment.url(:medium), controls: true, style: "max-width: 100%;"
              - if direction.dir_image?
                %span= link_to glyph(:camera), direction.dir_image.url(:medium)

      .panel-footer
        .row
          .col-md-12
            %h3 Comments
            %p
            = render @recipe.comments
            %br/
            - if user_signed_in?
              %p= render "comments/form"
            - else
              %p= link_to "Sign in to comment", new_user_session_path
